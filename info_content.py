variable_info_md = """
# Operationalisation Table

| Variable | Domain | Items Used | Method | Interpretation |
|---------|--------|------------|--------|----------------|
| D1_Justification | Citizenship, Rights, Responsibilities, Obligation | F115–F117 | REVERSE MEAN | Justification of Existing System |
| D1_Participation | Citizenship, Rights, Responsibilities, Obligation | E025–E029 | COUNT/5 | Unconventional Political Participation |
| D1_Political Interest | Citizenship, Rights, Responsibilities, Obligation | E023, E150 | MEAN | Political Interest |
| D2_Membership | Relation btw. Citizens and State | A065–A074 | COUNT | Civic Participation |
| D2_Proud of Nationality | Relation btw. Citizens and State | G006 | Raw | Pride in Nationality |
| D3_Confidence in Institutions | Legitimacy | E069_01–E069_17 (Selected) | Factor Analysis | Confidence in Institutions |
| D3_Confidence in the EU | Legitimacy | E069_18 | Raw | Confidence in the EU |
| D3_Support for Technocray&Authoritarianism | Legitimacy | E114–E116 | Factor Analysis | Support for authoritarian models |
| D3_Support for Democracy | Legitimacy | E117 | Raw | Support for democracy |
| Concern for Everyone | Social Cohesion & Mutual Regard | E154–E158 | Factor Analysis | Concern for Everyone |
| Concern for Vulnerable | Social Cohesion & Mutual Regard | E159–E162 | Raw | Concern for Vulnerable |
| D04_Autonomy-oriented child qualities | Social Cohesion & Mutual Regard | A029, A030, A034 | Count | Autonomy |
| D04_Conformity-oriented child qualities | Social Cohesion & Mutual Regard | A038, A040, A042 | Count | Conformity |
| D04_Prosocial/communal child qualities | Social Cohesion & Mutual Regard | A032, A035, A041, A039 | Count | Prosocial |
| D4_Gender Discrimination | Social Cohesion & Mutual Regard | D059, D060 | Factor Analysis | Gender Discrimination |
| D4_AntiImmigrant | Social Cohesion & Mutual Regard | C002, A124_02 | Recoded | Anti-Immigrant Attitudes |
| D4_Intolerance | Social Cohesion & Mutual Regard | A124_05, 06, 10 | Count | Intolerance |
| D4_Moral_Intolerance | Social Cohesion & Mutual Regard | A124_03, 08, 09 | Count | Moral Intolerance |
| D4_Generalized Trust | Social Cohesion & Mutual Regard | A165 | Raw | Generalized Trust |
| D5_Belief in Democracy | Justice & Fairness | E120–E123 | Factor Analysis (Reversed) | Support for Democracy |
| D5_ProMarket | Justice & Fairness | E035–E039 | Factor Analysis (Reversed) | ProMarket Attitudes |
| D6_Protestant Ethic | Justice & Fairness | C036–C039 | Factor Analysis (Reversed) | Protestant Ethic |
| Agency | Legitimacy/Resilience | A173 | Raw | Perceived freedom/control |
| Satisfaction with Life | Resilience | A170 | Raw | Subjective well-being |
| Post-Materialist index 4-item | Values | Y002 | Index | Post-materialist values |
| Autonomy Index | Values | Y003 | Index | Autonomy Index |

# Item-Level Descriptions

## Citizenship & Participation
- F115 — Justifiable: Avoiding a fare on public transport
- F116 — Justifiable: Cheating on taxes
- F117 — Justifiable: Someone accepting a bribe
- E025 — Political action: signing a petition
- E026 — Political action: joining in boycotts
- E027 — Political action: attending lawful/peaceful demonstrations
- E028 — Political action: joining unofficial strikes
- E029 — Political action: occupying buildings or factories
- E023 — Interest in politics
- E150 — How often follows politics in the news

## Group Membership (A065–A074)
- A065 — Member: Belong to religious organization
- A066 — Member: Belong to education, arts, music or cultural activities
- A067 — Member: Belong to labour unions
- A068 — Member: Belong to political parties
- A069 — Member: Belong to local political actions
- A070 — Member: Belong to human rights
- A071 — Member: Belong to conservation, the environment, ecology, animal rights
- A072 — Member: Belong to professional associations
- A073 — Member: Belong to youth work
- A074 — Member: Belong to sports or recreation

## National Identity
- G006 — How proud of nationality

## Institutions (E069)
- E069_01 — Confidence: Churches
- E069_02 — Confidence: Armed Forces
- E069_04 — Confidence: The Press
- E069_05 — Confidence: Labour Unions
- E069_06 — Confidence: The Police
- E069_07 — Confidence: Parliament
- E069_08 — Confidence: The Civil Services
- E069_17 — Confidence: Justice System/Courts
- E069_18 — Confidence: The European Union

## Political Systems (E114–E117)
- E114 — Political system: Having a strong leader
- E115 — Political system: Having experts make decisions
- E116 — Political system: Having the army rule
- E117 — Political system: Having a democratic political system

## Social Concern (E154–E162)
- E154 — Feel concerned about people in the neighbourhood
- E155 — Feel concerned about people in the region
- E156 — Feel concerned about fellow countrymen
- E157 — Feel concerned about Europeans
- E158 — Feel concerned about human kind
- E159 — Feel concerned about elderly people
- E160 — Feel concerned about unemployed people
- E161 — Feel concerned about immigrants
- E162 — Feel concerned about sick and disabled people

## Child Qualities (A029–A042)
- A029 — Important child qualities: independence
- A030 — Important child qualities: hard work
- A032 — Important child qualities: feeling of responsibility
- A034 — Important child qualities: imagination
- A035 — Important child qualities: tolerance and respect for other people
- A038 — Important child qualities: thrift saving money and things
- A039 — Important child qualities: determination perseverance
- A040 — Important child qualities: religious faith
- A041 — Important child qualities: unselfishness
- A042 — Important child qualities: obedience

## Gender & Discrimination
- D059 — Men make better political leaders than women do
- D060 — University is more important for a boy than for a girl
- C002 — Jobs scarce: Employers should give priority to (nation) people than immigrants

## Intolerance / Neighbors (A124)
- A124_02 — Neighbours: People of a different race
- A124_03 — Neighbours: Heavy drinkers
- A124_05 — Neighbours: Muslims
- A124_06 — Neighbours: Immigrants/foreign workers
- A124_08 — Neighbours: Drug addicts
- A124_09 — Neighbours: Homosexuals
- A124_10 — Neighbours: Jews

## Trust
- A165 — Most people can be trusted

## Democratic Performance (E120–E123)
- E120 — In democracy, the economic system runs badly
- E121 — Democracies are indecisive and have too much squabbling
- E122 — Democracies aren´t good at maintaining order
- E123 — Democracy may have problems but is better

## Economic & Work Values
- E035 — Income equality
- E036 — Private vs state ownership of business
- E037 — Government responsibility
- E038 — Job taking of the unemployed
- E039 — Competition good or harmful
- C036 — To develop talents you need to have a job
- C037 — Humiliating to receive money without having to work for it
- C038 — People who don´t work turn lazy
- C039 — Work is a duty towards society
"""

def get_schema_dict():
    """Parses the markdown table into a dictionary keyed by Variable name."""
    lines = variable_info_md.strip().splitlines()
    
    # Find table start
    table_lines = []
    in_table = False
    for line in lines:
        if line.strip().startswith('| Variable |'):
            in_table = True
        if in_table:
            if line.strip() == '' or line.startswith('#'):
                if len(table_lines) > 2: # End of table
                    break
            if line.strip() != "":
                table_lines.append(line)
            
    if not table_lines:
        return {}

    # Parse headers
    headers = [h.strip() for h in table_lines[0].split('|') if h.strip()]
    
    schema = {}
    # Skip header and separator
    for line in table_lines[2:]:
        if not line.strip(): continue
        if line.strip().startswith("|---"): continue
        
        row = [cell.strip() for cell in line.split('|') if cell.strip()]
        # Handle pipe at start/end
        # Split puts '' at start/end if pipe is there
        row = [cell.strip() for cell in line.strip().strip('|').split('|')]
        
        if len(row) >= len(headers):
            # Create a dict for this row
            row_dict = {headers[i]: row[i].strip() for i in range(len(headers))}
            # Key by Variable name
            var_name = row_dict.get('Variable')
            if var_name:
                schema[var_name] = row_dict
                
    return schema

def get_item_descriptions():
    """Parses the item-level descriptions into a dictionary {ItemCode: Description}."""
    lines = variable_info_md.strip().splitlines()
    
    items = {}
    import re
    # Regex to match "- CODE — Description"
    # Handles codes like G006, E069_01
    pattern = re.compile(r'-\s+([A-Z0-9_]+)\s+[—–-]\s+(.+)')
    
    for line in lines:
        line = line.strip()
        match = pattern.match(line)
        if match:
            code = match.group(1).strip()
            desc = match.group(2).strip()
            items[code] = desc
            
    return items
